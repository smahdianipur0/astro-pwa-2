---
import Menu from '../components/ui/Menu';
import KeyIv from '../components/KeyIv.astro';
---

<div class="bottom-nav-parent">
    
    <div class="bottom-nav bottom-nav-one glass box-shadow ">

        <input 
            type="radio" 
            name="tab" 
            class="hide-checkbox" 
            id="one" 
            tabindex="1" checked />

        <label class="nav-div" for="one" id="l_one">
            <svg class="svg-icon" width="24" height="24" fill="none" viewBox="0 0 24 24">
                <path class="p_one" d="M10.55 2.533a2.25 2.25 0 0 1 2.9 0l6.75 5.695c.508.427.8 1.056.8 1.72v9.802a1.75 1.75 0 0 1-1.75 1.75h-3a1.75 1.75 0 0 1-1.75-1.75v-5a.75.75 0 0 0-.75-.75h-3.5a.75.75 0 0 0-.75.75v5a1.75 1.75 0 0 1-1.75 1.75h-3A1.75 1.75 0 0 1 3 19.75V9.947c0-.663.292-1.292.8-1.72l6.75-5.694Z" fill="#ffffff" />
            </svg>

            <div class="nav-text nav-text-one no-select">Home</div>
        </label>


        <input 
            type="radio" 
            name="tab" 
            class="hide-checkbox" 
            id="two" />

        <label class="nav-div" for="two" id="l_two">
            <svg class="svg-icon" width="24" height="24" fill="none" viewBox="0 0 24 24" >
                <path class="p_two" d="M14 13.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z" fill="#fff"/>
                <path class="p_two" d="M2 7.75A3.75 3.75 0 0 1 5.75 4h12.5A3.75 3.75 0 0 1 22 7.75v8.5A3.75 3.75 0 0 1 18.25 20H5.75A3.75 3.75 0 0 1 2 16.25v-8.5ZM5.75 7a.75.75 0 0 0-.75.75v8.5a.75.75 0 0 0 1.5 0v-8.5A.75.75 0 0 0 5.75 7Zm5.53 1.22a.75.75 0 1 0-1.06 1.06l1.195 1.196A2.985 2.985 0 0 0 11 12c0 .556.151 1.077.415 1.524L10.22 14.72a.75.75 0 1 0 1.06 1.06l1.196-1.195c.447.264.968.415 1.524.415s1.077-.151 1.524-.415l1.196 1.195a.75.75 0 1 0 1.06-1.06l-1.195-1.196c.264-.447.415-.968.415-1.524s-.151-1.077-.415-1.524L17.78 9.28a.75.75 0 0 0-1.06-1.06l-1.196 1.195A2.986 2.986 0 0 0 14 9c-.556 0-1.077.151-1.524.415L11.28 8.22Z" fill="#fff"/>
            </svg>

            <div class="nav-text nav-text-two no-select">Records</div>
        </label>


        <input 
            type="radio" 
            name="tab" 
            class="hide-checkbox" 
            id="three" />

        <label class="nav-div" for="three" id="l_three">
            <svg class="svg-icon" width="24" height="24" fill="none" viewBox="0 0 24 24">
                <path class="l_three" d="M12 1.999c5.524 0 10.002 4.478 10.002 10.002 0 5.523-4.478 10.001-10.002 10.001-5.524 0-10.002-4.478-10.002-10.001C1.998 6.477 6.476 1.999 12 1.999Zm-.004 8.25a1 1 0 0 0-.992.885l-.007.116.003 5.502.007.117a1 1 0 0 0 1.987-.002L13 16.75l-.003-5.501-.007-.117a1 1 0 0 0-.994-.882ZM12 6.5a1.251 1.251 0 1 0 0 2.503A1.251 1.251 0 0 0 12 6.5Z" fill="#ffffff" />
            </svg>

            <div class="nav-text nav-text-three no-select">About</div>
        </label>
        
    </div>

    <div class="bottom-nav bottom-nav-two glass box-shadow">

        <Menu client:load>
            <fragment slot="trigger">
                <div class="nav-div" id="l_four">

                    <svg class="svg-icon" width="24" height="24" fill="none" viewBox="0 0 24 24" >
                        <path class="l_four" d="M3 5.75V11c0 5.001 2.958 8.676 8.725 10.948a.75.75 0 0 0 .55 0C18.042 19.676 21 16 21 11V5.75a.75.75 0 0 0-.75-.75c-2.663 0-5.258-.943-7.8-2.85a.75.75 0 0 0-.9 0C9.008 4.057 6.413 5 3.75 5a.75.75 0 0 0-.75.75ZM13.995 11a2 2 0 0 1-1.245 1.852v2.398a.75.75 0 0 1-1.5 0v-2.394A2 2 0 1 1 13.995 11Z" fill="#fff"/>
                    </svg>      

                    <div class="nav-text nav-text-four no-select">Key & IV</div>
                </div>
            </fragment>

            <fragment slot="content" > 
                <div
                    class="glass subtle-shadow" 
                    style="   width: var(--size-xl4);
                    border-radius: var(--radius-b);
                    background-color: oklch(var(--gray-25) / 55%);
                    padding: var(--size-sm3);">

                    <KeyIv/> 
                </div>
            </fragment>
        </Menu>

    </div>

</div>
<div class="gradient-blur"> <div></div> <div></div> </div>

<script>
  
const params: URLSearchParams = new URLSearchParams(window.location.search);


function updateURLForRadios(): void {
  if (document.querySelector('input[name="tab"]:checked')) {
    params.set(
      "tab",
      (document.querySelector('input[name="tab"]:checked') as HTMLInputElement).id,
    );
  }

  window.history.replaceState({}, "", `${window.location.pathname}?${params}`);
}

function setInitialRadioStates(): void {
  const tabValue = params.get("tab");

  if (tabValue) {
    const tabRadioToCheck = document.querySelector(
      `input[name="tab"][id="${tabValue}"]`,
    ) as HTMLInputElement;
    if (tabRadioToCheck) {
      tabRadioToCheck.checked = true;
    }
  }
}

setInitialRadioStates();

const allTabRadios = document.querySelectorAll('input[name="tab"]');
allTabRadios.forEach((radio) => {
  radio.addEventListener("change", updateURLForRadios);
});

</script>
<script src="../components/keyIv.ts"></script>

<style is:global>


.svg-icon{
    width: var(--size-md2);
    height: var(--size-md2);
    padding: 2px;
}

.bottom-nav-parent{
    z-index: var(--z-layer-pos-4);
    width: calc(100% - (var(--size-sm2) * 2));
    top: auto;
    bottom: var(--size-sm3);
    left: var(--size-sm2);
    right: var(--size-sm2);
    display: flex;
    position: fixed;
    gap: 2%;
}

.bottom-nav{
    z-index: inherit;
    width: inherit;
    height: inherit;
    display: inherit;
    background-color: oklch(var(--gray-10) / 0.4);
    border-radius: 100px; 
}

.bottom-nav-one{
    width: 74%;
    justify-content: space-around;
}

.bottom-nav-two{
    width: 24%;
    justify-content: center;
}

/* .bottom-nav-one::after,  .bottom-nav-two::after{
  content: "";
  position: absolute;
  inset: 0;
  border-radius: 100px;
  border: 0.5px solid transparent;
  -webkit-mask: linear-gradient(#fff 0 0) padding-box,linear-gradient(#fff 0 0);
  -webkit-mask-composite: destination-out;
  mask-composite: exclude;
  pointer-events: none;
  background: linear-gradient(to bottom, oklch(100% 0 0 / 10%) 0%, oklch(100% 0 0 / 0%) 180%) border-box;
} */

.nav-div{
    width: var(--size-lg3);
    height: var(--size-lg1) ;
    display: flex; 
    flex-direction: column;
    justify-content: space-around; 
    justify-content: center;
    align-items: center;
    margin-block-end: var(--size-xs1);
}

.nav-text{
    line-height: 1;
    font-size: var(--font-sm3); 
    text-align: center;
    color: oklch(var(--gray-95) / 0.5);
    padding-top: 2px;
}

.p_one, .p_two, .l_three, .l_four {
  fill: oklch(var(--gray-95) / 0.5); 
}

:root:has(#one:checked) .p_one,  
:root:has(#two:checked) .p_two,  
:root:has(#three:checked) .l_three {  
  fill: oklch(var(--primary));  
}  

:root:has(#one:checked) .nav-text-one,  
:root:has(#two:checked) .nav-text-two,  
:root:has(#three:checked) .nav-text-three {  
  color: oklch(var(--primary));  
} 

.tab-content {
    display: none;
    width: 100%;
}

:root:has(#one:checked) .tab-content.one,  
:root:has(#two:checked) .tab-content.two,  
:root:has(#three:checked) .tab-content.three {  
    display: block;  
}  


:root:has(#one:focus-visible) #l_one,
:root:has(#two:focus-visible)  #l_two ,
:root:has(#three:focus-visible) #l_three,
:root:has(#four:focus-visible)  #l_four  {
    outline: Highlight auto 1px;
    outline: -webkit-focus-ring-color auto 1px;
}

.gradient-blur{
    position: fixed;
    z-index: var( --z-layer-pos-3);
    inset: auto 0 -1px 0;
    height: var(--size-md4);
    pointer-events: none;
}

.gradient-blur > div,
.gradient-blur::before,
.gradient-blur::after{
    position: absolute;
    inset: 0;
}

.gradient-blur::before {
  content: "";
  z-index: 1;
  backdrop-filter: blur(0.5px);
  mask: linear-gradient(to bottom, #00000000 0%, #000000 25%, #000000 50%,#00000000 37.5%);
}

.gradient-blur > div:nth-of-type(1) {
  z-index: 2;
  backdrop-filter: blur(2px);
  mask: linear-gradient(to bottom, #00000000 25%, #000000 50%,#000000 75%,#00000000 50%);
}

.gradient-blur > div:nth-of-type(2) {
  z-index: 3;
  backdrop-filter: blur(3px);
  mask: linear-gradient(to bottom,#00000000 50%,#000000 75%,#000000 100%,#00000000 62.5%);
}


.gradient-blur::after {
  content: "";
  z-index: 4;
  backdrop-filter: blur(5px);
  mask: linear-gradient(to bottom,#00000000 87.5%,#000000 100%);
}


@media only screen and (min-width: 450px) {
  .bottom-nav-parent{
    bottom: auto;
    top: var(--size-sm0);
    height: var(--size-lg1);
  }

  .tab-content .grid-layout{
    margin-top: var(--size-lg3);
  }

  .nav-div {
    flex-direction: row;
    height: var(--size-md2);
    margin-top: auto;
    margin-bottom: auto;
  }

  .nav-text{
    font-size: var(--font-sm4);
    margin-top: auto;
    margin-bottom: auto;
    text-align: start;
    padding-inline: var(--size-sm0);
  }

  .toast {
    margin-bottom: 0;
  }
  .gradient-blur{
    inset: -1px 0 auto 0;
    transform: scaleY(-1);
  }
}

</style>